---
title: "[validmind](/reference/validmind.html).vm_models"
sidebar: validmind-reference
toc-depth: 4
toc-expand: 4
# module.qmd.jinja2
---

<!-- docstring.jinja2 -->

Models entrypoint

<!-- class.qmd.jinja2 -->

## [class]{.muted} Figure

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">Figure</span>()

:::

<!-- docstring.jinja2 -->

Figure objects track the schema supported by the ValidMind API

### [serialize[()]{.muted}](#serialize)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">serialize</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Serializes the Figure to a dictionary so it can be sent to the API

### [serialize_files[()]{.muted}](#serialize_files)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">serialize_files</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Creates a `requests`-compatible files object to be sent to the API

### [to_widget[()]{.muted}](#to_widget)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">to_widget</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Returns the ipywidget compatible representation of the figure. Ideally we would render images as-is, but Plotly FigureWidgets don't work well on Google Colab when they are combined with ipywidgets.

<!-- class.qmd.jinja2 -->

## [class]{.muted} ModelAttributes

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">ModelAttributes</span>()

:::

<!-- docstring.jinja2 -->

Model attributes definition

### [from_dict[()]{.muted}](#from_dict)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">from_dict</span>(<span class="params"><span class="n">cls</span><span class="muted">,</span></span><span class="params"><span class="n">data</span></span>)

:::

<!-- docstring.jinja2 -->

Creates a ModelAttributes instance from a dictionary

<!-- class.qmd.jinja2 -->

## [class]{.muted} TestSuite

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">TestSuite</span>()

:::

<!-- docstring.jinja2 -->

Base class for test suites. Test suites are used to define a grouping of tests that can be run as a suite against datasets and models. Test Suites can be defined by inheriting from this base class and defining the list of tests as a class variable.

Tests can be a flat list of strings or may be nested into sections by using a dict

### [get_default_config[()]{.muted}](#get_default_config)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">get_default_config</span>(<span class="param"><span class="n">self</span></span>)<span class="p"> → </span><span class="return-annotation">dict</span>

:::

<!-- docstring.jinja2 -->

Returns the default configuration for the test suite Each test in a test suite can accept parameters and those parameters can have default values. Both the parameters and their defaults are set in the test class and a config object can be passed to the test suite's run method to override the defaults. This function returns a dictionary containing the parameters and their default values for every test to allow users to view and set values

**Returns**

- A dictionary of test names and their default parameters

### [get_tests[()]{.muted}](#get_tests)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">get_tests</span>(<span class="param"><span class="n">self</span></span>)<span class="p"> → </span><span class="return-annotation">List[str]</span>

:::

<!-- docstring.jinja2 -->

Get all test suite test objects from all sections

### [num_tests[()]{.muted}](#num_tests)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">num_tests</span>(<span class="param"><span class="n">self</span></span>)<span class="p"> → </span><span class="return-annotation">int</span>

:::

<!-- docstring.jinja2 -->

Returns the total number of tests in the test suite

<!-- class.qmd.jinja2 -->

## [class]{.muted} TestSuiteRunner

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">TestSuiteRunner</span>()

:::

<!-- docstring.jinja2 -->

Runs a test suite

### [log_results[()]{.muted}](#log_results)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">log_results</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Logs the results of the test suite to ValidMind This method will be called after the test suite has been run and all results have been collected. This method will log the results to ValidMind.

### [run[()]{.muted}](#run)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">run</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">send</span><span class="p">:</span><span class="n">bool</span><span class="o"> = </span><span class="kc">True</span><span class="muted">,</span></span><span class="params"><span class="n">fail_fast</span><span class="p">:</span><span class="n">bool</span><span class="o"> = </span><span class="kc">False</span></span>)

:::

<!-- docstring.jinja2 -->

Runs the test suite, renders the summary and sends the results to ValidMind

**Parameters**

- **send** (bool): Whether to send the results to ValidMind. Defaults to True.
- **fail_fast** (bool): Whether to stop running tests after the first failure. Defaults to False.

### [summarize[()]{.muted}](#summarize)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">summarize</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">show_link</span><span class="p">:</span><span class="n">bool</span><span class="o"> = </span><span class="kc">True</span></span>)

:::

<!-- class.qmd.jinja2 -->

## [class]{.muted} VMDataset

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">VMDataset</span>()

:::

<!-- docstring.jinja2 -->

Base class for VM datasets Child classes should be used to support new dataset types (tensor, polars etc) by converting the user's dataset into a numpy array collecting metadata like column names and then call this (parent) class `__init__` method.

This way we can support multiple dataset types but under the hood we only need to work with numpy arrays and pandas dataframes in this class.

**Parameters**

- **raw_dataset** (np.ndarray): The raw dataset as a NumPy array.
- **input_id** (str): Identifier for the dataset.
- **index** (np.ndarray): The raw dataset index as a NumPy array.
- **columns** (Set[str]): The column names of the dataset.
- **target_column** (str): The target column name of the dataset.
- **feature_columns** (List[str]): The feature column names of the dataset.
- **feature_columns_numeric** (List[str]): The numeric feature column names of the dataset.
- **feature_columns_categorical** (List[str]): The categorical feature column names of the dataset.
- **text_column** (str): The text column name of the dataset for NLP tasks.
- **target_class_labels** (Dict): The class labels for the target columns.
- **df** (pd.DataFrame): The dataset as a pandas DataFrame.
- **extra_columns** (Dict): Extra columns to include in the dataset.

**Inherited members**

### [add_extra_column[()]{.muted}](#add_extra_column)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">add_extra_column</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">column_name</span><span class="muted">,</span></span><span class="params"><span class="n">column_values</span><span class="o"> = </span><span class="kc">None</span></span>)

:::

<!-- docstring.jinja2 -->

Adds an extra column to the dataset without modifying the dataset `features` and `target` columns.

**Parameters**

- **column_name** (str): The name of the extra column.
- **column_values** (np.ndarray): The values of the extra column.

### [assign_predictions[()]{.muted}](#assign_predictions)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">assign_predictions</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span><span class="p">:</span><span class="n">VMModel</span><span class="muted">,</span></span><span class="params"><span class="n">prediction_column</span><span class="p">:</span><span class="n">str</span><span class="o"> = </span><span class="kc">None</span><span class="muted">,</span></span><span class="params"><span class="n">prediction_values</span><span class="p">:</span><span class="n">list</span><span class="o"> = </span><span class="kc">None</span><span class="muted">,</span></span><span class="params"><span class="n">probability_column</span><span class="p">:</span><span class="n">str</span><span class="o"> = </span><span class="kc">None</span><span class="muted">,</span></span><span class="params"><span class="n">probability_values</span><span class="p">:</span><span class="n">list</span><span class="o"> = </span><span class="kc">None</span><span class="muted">,</span></span><span class="params"><span class="n">prediction_probabilities</span><span class="p">:</span><span class="n">list</span><span class="o"> = </span><span class="kc">None</span><span class="muted">,</span></span><span class="params"><span class="n">kwargs</span><span class="o"> = </span><span class="kc">{}</span></span>)

:::

<!-- docstring.jinja2 -->

Assign predictions and probabilities to the dataset.

**Parameters**

- **model** (VMModel): The model used to generate the predictions.
- **prediction_column** (str, optional): The name of the column containing the predictions. Defaults to None.
- **prediction_values** (list, optional): The values of the predictions. Defaults to None.
- **probability_column** (str, optional): The name of the column containing the probabilities. Defaults to None.
- **probability_values** (list, optional): The values of the probabilities. Defaults to None.
- **prediction_probabilities** (list, optional): DEPRECATED: The values of the probabilities. Defaults to None.
- **kwargs**: Additional keyword arguments that will get passed through to the model's `predict` method.

### [prediction_column[()]{.muted}](#prediction_column)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">prediction_column</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span><span class="p">:</span><span class="n">VMModel</span><span class="muted">,</span></span><span class="params"><span class="n">column_name</span><span class="p">:</span><span class="n">str</span><span class="o"> = </span><span class="kc">None</span></span>)<span class="p"> → </span><span class="return-annotation">str</span>

:::

<!-- docstring.jinja2 -->

Get or set the prediction column for a model.

### [probability_column[()]{.muted}](#probability_column)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">probability_column</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span><span class="p">:</span><span class="n">VMModel</span><span class="muted">,</span></span><span class="params"><span class="n">column_name</span><span class="p">:</span><span class="n">str</span><span class="o"> = </span><span class="kc">None</span></span>)<span class="p"> → </span><span class="return-annotation">str</span>

:::

<!-- docstring.jinja2 -->

Get or set the probability column for a model.

### [target_classes[()]{.muted}](#target_classes)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">target_classes</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Returns the target class labels or unique values of the target column.

### [with_options[()]{.muted}](#with_options)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">with_options</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">kwargs</span><span class="o"> = </span><span class="kc">{}</span></span>)<span class="p"> → </span><span class="return-annotation"><a href="/reference/validmind/vm_models.html#class-vmdataset"> validmind.vm_models.VMDataset </a></span>

:::

<!-- docstring.jinja2 -->

Support options provided when passing an input to run_test or run_test_suite

**Parameters**

- \*\***kwargs**: Options:
- columns: Filter columns in the dataset

**Returns**

- A new instance of the dataset with only the specified columns

### [x_df[()]{.muted}](#x_df)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">x_df</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Returns a dataframe containing only the feature columns

### [y_df[()]{.muted}](#y_df)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">y_df</span>(<span class="param"><span class="n">self</span></span>)<span class="p"> → </span><span class="return-annotation">pd.DataFrame</span>

:::

<!-- docstring.jinja2 -->

Returns a dataframe containing the target column

### [y_pred[()]{.muted}](#y_pred)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">y_pred</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span></span>)<span class="p"> → </span><span class="return-annotation">np.ndarray</span>

:::

<!-- docstring.jinja2 -->

Returns the predictions for a given model. Attempts to stack complex prediction types (e.g., embeddings) into a single, multi-dimensional array.

**Parameters**

- **model** (VMModel): The model whose predictions are sought.

**Returns**

- The predictions for the model

### [y_pred_df[()]{.muted}](#y_pred_df)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">y_pred_df</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span></span>)<span class="p"> → </span><span class="return-annotation">pd.DataFrame</span>

:::

<!-- docstring.jinja2 -->

Returns a dataframe containing the predictions for a given model

### [y_prob[()]{.muted}](#y_prob)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">y_prob</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span></span>)<span class="p"> → </span><span class="return-annotation">np.ndarray</span>

:::

<!-- docstring.jinja2 -->

Returns the probabilities for a given model.

**Parameters**

- **model** (str): The ID of the model whose predictions are sought.

**Returns**

- The probability variables.

### [y_prob_df[()]{.muted}](#y_prob_df)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">y_prob_df</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">model</span></span>)<span class="p"> → </span><span class="return-annotation">pd.DataFrame</span>

:::

<!-- docstring.jinja2 -->

Returns a dataframe containing the probabilities for a given model

<!-- class.qmd.jinja2 -->

## [class]{.muted} VMInput

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">VMInput</span>()

:::

<!-- docstring.jinja2 -->

Base class for ValidMind Input types

**Inherited members**

### [with_options[()]{.muted}](#with_options)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">with_options</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">kwargs</span><span class="o"> = </span><span class="kc">{}</span></span>)<span class="p"> → </span><span class="return-annotation"><a href="/reference/validmind/vm_models.html#class-vminput"> validmind.vm_models.VMInput </a></span>

:::

<!-- docstring.jinja2 -->

Allows for setting options on the input object that are passed by the user when using the input to run a test or set of tests

To allow options, just override this method in the subclass (see VMDataset) and ensure that it returns a new instance of the input with the specified options set.

**Parameters**

- \*\***kwargs**: Arbitrary keyword arguments that will be passed to the input object

**Returns**

- A new instance of the input with the specified options set

<!-- class.qmd.jinja2 -->

## [class]{.muted} VMModel

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">class</span> <span class="name">VMModel</span>()

:::

<!-- docstring.jinja2 -->

An base class that wraps a trained model instance and its associated data.

**Parameters**

- **model** (object, optional): The trained model instance. Defaults to None.
- **input_id** (str, optional): The input ID for the model. Defaults to None.
- **attributes** (ModelAttributes, optional): The attributes of the model. Defaults to None.
- **name** (str): The name of the model. Defaults to the class name.

**Inherited members**

### [predict[()]{.muted}](#predict)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">predict</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">args</span><span class="o"> = </span><span class="kc">()</span><span class="muted">,</span></span><span class="params"><span class="n">kwargs</span><span class="o"> = </span><span class="kc">{}</span></span>)

:::

<!-- docstring.jinja2 -->

Predict method for the model. This is a wrapper around the model's

### [predict_proba[()]{.muted}](#predict_proba)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">predict_proba</span>(<span class="params"><span class="n">self</span><span class="muted">,</span></span><span class="params"><span class="n">args</span><span class="o"> = </span><span class="kc">()</span><span class="muted">,</span></span><span class="params"><span class="n">kwargs</span><span class="o"> = </span><span class="kc">{}</span></span>)

:::

<!-- docstring.jinja2 -->

Predict probabilties - must be implemented by subclass if needed

### [serialize[()]{.muted}](#serialize)

<!-- signatures.jinja2 -->

::: {.signature}

<span class="kw">def</span> <span class="name">serialize</span>(<span class="param"><span class="n">self</span></span>)

:::

<!-- docstring.jinja2 -->

Serializes the model to a dictionary so it can be sent to the API
